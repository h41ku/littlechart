!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(self,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function i(t,e=.001){return Math.abs(t)<e}function n(t=0,e=0){return[t,e]}function o(t,e){return t[0]=e[0],t[1]=e[1],t}function s(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function l(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function r(t,e,i,n){return t[0]=e[0]*i[0]+n[0],t[1]=e[1]*i[1]+n[1],t}t.r(e),t.d(e,{Chart:()=>R,Dataset:()=>S});const a=t=>{t.preventDefault(),t.stopPropagation(),console.log("drop",t.type)},f="sim:pointerdown",c="sim:pointermove",h="sim:pointerup",u="sim:pointerzoom",d={listenerElement:null,invertMouseWheel:!1,mouseWheelStep:.1};class x{constructor(t,e={}){const i={...d,...e};this.element=t,this.listenerElement=null!==i.listenerElement?i.listenerElement:t;const n=(t,e)=>this.element.dispatchEvent(new CustomEvent(t,{detail:e})),o=(t,e,i)=>n(f,{originalEvent:t,clientX:e,clientY:i}),s=(t,e,i)=>n(h,{originalEvent:t,clientX:e,clientY:i}),l=(t,e,i,o)=>n(u,{originalEvent:t,clientX:e,clientY:i,deltaScale:o}),r=(t,e,i,o,s)=>n(c,{originalEvent:t,clientX:e,clientY:i,movementX:o,movementY:s});let a=null,x=null;const g={x:0,y:0},p={x:0,y:0},m=i.invertMouseWheel?-1:1,b=i.mouseWheelStep;this.listeners={touchstart:t=>{let e;const i=t.target.getBoundingClientRect();if(null!==a){const n=t.changedTouches[0];if(n.identifier!==a){let l;x=n.identifier,p.x=n.clientX-i.left,p.y=n.clientY-i.top,l=s(t,g.x,g.y),!1===l&&(e=!1),l=o(t,g.x+(p.x-g.x)/2,g.y+(p.y-g.y)/2),!1===l&&(e=!1)}}else{const n=t.changedTouches[0];let s;a=n.identifier,g.x=n.clientX-i.left,g.y=n.clientY-i.top,s=o(t,g.x,g.y),!1===s&&(e=!1)}return!1===e&&(t.stopPropagation(),t.preventDefault()),e},touchend:t=>{let e,i=Array.from(t.changedTouches);if(null!==a&&null!==x){const n=i.find((t=>a===t.identifier)),l=i.find((t=>x===t.identifier));let r;r=s(t,g.x+(p.x-g.x)/2,g.y+(p.y-g.y)/2),!1===r&&(e=!1),n&&l?(a=null,x=null):n&&!l?(a=x,g.x=p.x,g.y=p.y,x=null):!n&&l&&(x=null),null!==a&&(r=o(t,g.x,g.y),!1===r&&(e=!1))}else if(null!==a&&i.find((t=>a===t.identifier))){let i;a=null,i=s(t,g.x,g.y),!1===i&&(e=!1)}return!1===e&&(t.stopPropagation(),t.preventDefault()),e},touchmove:t=>{let e;const i=t.target.getBoundingClientRect();if(null!==a&&null!==x){const n={x:g.x,y:g.y},f={x:p.x,y:p.y},c=Array.from(t.changedTouches).find((t=>a===t.identifier)),h=Array.from(t.changedTouches).find((t=>x===t.identifier));c&&(n.x=c.clientX-i.left,n.y=c.clientY-i.top),h&&(f.x=h.clientX-i.left,f.y=h.clientY-i.top);const u=p.x-g.x,d=p.y-g.y,m=f.x-n.x,b=f.y-n.y,y=1-Math.hypot(u,d)/Math.hypot(m,b),v={x:g.x+u/2,y:g.y+d/2},M={x:n.x+m/2,y:n.y+b/2};let R;R=r(t,M.x,M.y,M.x-v.x,M.y-v.y),!1===R&&(e=!1),R=s(t,M.x,M.y),!1===R&&(e=!1),R=l(t,M.x,M.y,y),!1===R&&(e=!1),R=o(t,M.x,M.y),!1===R&&(e=!1),g.x=n.x,g.y=n.y,p.x=f.x,p.y=f.y}else if(null!==a){const n={x:g.x,y:g.y},o=Array.from(t.changedTouches).find((t=>a===t.identifier));if(!o)return;let s;n.x=o.clientX-i.left,n.y=o.clientY-i.top,s=r(t,n.x,n.y,n.x-g.x,n.y-g.y),!1===s&&(e=!1),g.x=n.x,g.y=n.y}return!1===e&&(t.stopPropagation(),t.preventDefault()),e},mousedown:t=>{g.x=t.clientX,g.y=t.clientY;let e=o(t,g.x,g.y);return!1===e&&(t.stopPropagation(),t.preventDefault()),e},mouseup:t=>{g.x=t.clientX,g.y=t.clientY;let e=s(t,g.x,g.y);return!1===e&&(t.stopPropagation(),t.preventDefault()),e},mousemove:t=>{let e={x:t.clientX,y:t.clientY},i=r(t,e.x,e.y,e.x-g.x,e.y-g.y);return g.x=e.x,g.y=e.y,!1===i&&(t.stopPropagation(),t.preventDefault()),i},wheel:t=>{const e=b*(t.deltaY>0?1:-1)*m,i=l(t,t.clientX,t.clientY,e);return!1===i&&(t.stopPropagation(),t.preventDefault()),i}}}enableNativeGestures(){document.removeEventListener("gesturestart",a),document.removeEventListener("gesturechange",a),document.removeEventListener("gestureend",a)}disableNativeGestures(){document.addEventListener("gesturestart",a),document.addEventListener("gesturechange",a),document.addEventListener("gestureend",a)}enableTouchGestures(){this.listenerElement.addEventListener("touchstart",this.listeners.touchstart),document.addEventListener("touchend",this.listeners.touchend),document.addEventListener("touchmove",this.listeners.touchmove)}disableTouchGestures(){this.listenerElement.removeEventListener("touchstart",this.listeners.touchstart),document.removeEventListener("touchend",this.listeners.touchend),document.removeEventListener("touchmove",this.listeners.touchmove)}enableMouseGestures(){this.listenerElement.addEventListener("mousedown",this.listeners.mousedown),document.addEventListener("mouseup",this.listeners.mouseup),document.addEventListener("mousemove",this.listeners.mousemove),this.listenerElement.addEventListener("wheel",this.listeners.wheel),document.addEventListener("mouseleave",this.listeners.mouseup)}disableMouseGestures(){this.listenerElement.removeEventListener("mousedown",this.listeners.mousedown),document.removeEventListener("mouseup",this.listeners.mouseup),document.removeEventListener("mousemove",this.listeners.mousemove),document.removeEventListener("wheel",this.listeners.wheel),document.removeEventListener("mouseleave",this.listeners.mouseup)}}x.EVT_NAME_POINTERDOWN=f,x.EVT_NAME_POINTERMOVE=c,x.EVT_NAME_POINTERUP=h,x.EVT_NAME_POINTERZOOM=u;const g=x;function p(t,e){const i={...t,...e};return Object.entries(e).forEach((({0:e,1:n})=>{e in t&&"object"==typeof n&&!(t=>t instanceof Array)(n)&&null!==n&&(i[e]=p(t[e],n))})),i}const m={focus:{points:{innerRadius:t=>2*t.options.lineWidth,outerRadius:t=>2*t.options.lineWidth+t.options.lineWidth},axes:{x:{color:"rgba(0,0,0,0.1)",lineWidth:1},y:{color:"rgba(0,0,0,0.1)",lineWidth:1}}},color:{border:"rgba(0,0,0,0)",background:"#000000",text:"#ffffff"},shadow:{offsetX:0,offsetY:15,blur:5,color:"rgba(0,0,0,0.2)"},borderRadius:{leftTop:5,rightTop:5,leftBottom:5,rightBottom:5},viewportPadding:{left:15,right:15,top:15,bottom:15},padding:{left:25,right:10,top:5,bottom:5},mark:{offsetLeft:15,offsetTop:15,innerRadius:0,outerRadius:3},splitter:{height:5},unitInvisibleHints:!0,maxNumIterations:20},b={color:{border:"#eeeeee",background:"#ffffff",text:"#000000"},padding:{left:5,right:5,top:5,bottom:5},itemPadding:{left:25,right:10,top:5,bottom:5},mark:{offsetLeft:15,offsetTop:15,innerRadius:0,outerRadius:3}};function y(t,e){return t.bottom>e.top&&t.right>e.left&&t.top<e.bottom&&t.left<e.right}function v(t){const e=t.length;for(let i=0;i<e;i++)for(let n=0;n<e;n++)if(i!==n&&y(t[i].boundingRect,t[n].boundingRect))return!0;return!1}const M={xCanvasStep:25,yCanvasStep:25,xAxisStep:1,yAxisStep:1,xOffset:0,yOffset:0,xScale:1,yScale:1,xAxisSubdivisions:10,yAxisSubdivisions:10,lineWidth:1,pointSize:0,fontSize:15,fontFamily:"monospace",xAxisLabelXOffset:0,xAxisLabelYOffset:0,xAxisLabelDynamicPosition:!0,xAxisLabelSpacing:15,xAxisLabelFormat:t=>t.toFixed(4),xAxisLabelJoiningStep:5,xAxisLabelMarkOffset:-2,xAxisLabelMarkSize:4,xAxisLabelDisplayZero:!0,xAxisLabelEnable:!0,yAxisLabelXOffset:0,yAxisLabelYOffset:0,yAxisLabelDynamicPosition:!0,yAxisLabelSpacing:0,yAxisLabelFormat:t=>t.toFixed(4),yAxisLabelJoiningStep:5,yAxisLabelMarkOffset:-2,yAxisLabelMarkSize:4,yAxisLabelDisplayZero:!0,yAxisLabelEnable:!0,backgroundColor:"#ffffff",gridColor:"rgba(0,0,0,0.1)",axesColor:"rgba(0,0,0,0.5)",userTranslateX:!0,userTranslateY:!0,userScaleX:!0,userScaleY:!0,canvasRatio:1,canvasPixelRatio:1,clearFrame:!1,hints:{settings:{focus:{points:{innerRadius:t=>2*t.options.lineWidth,outerRadius:t=>2*t.options.lineWidth+t.options.lineWidth},axes:{x:{color:"rgba(0,0,0,0.1)",lineWidth:1},y:{color:"rgba(0,0,0,0.1)",lineWidth:1}}},color:{border:"rgba(0,0,0,0)",background:"#000000",text:"#ffffff"},shadow:{offsetX:0,offsetY:15,blur:5,color:"rgba(0,0,0,0.2)"},borderRadius:{leftTop:5,rightTop:5,leftBottom:5,rightBottom:5},viewportPadding:{left:15,right:15,top:15,bottom:15},padding:{left:25,right:10,top:5,bottom:5},mark:{offsetLeft:15,offsetTop:15,innerRadius:0,outerRadius:3},splitter:{height:5},unitInvisibleHints:!0,maxNumIterations:20},hintText:(t,e,i,n,o)=>`X: ${n.xAxisLabelFormat(t)}\nY: ${n.yAxisLabelFormat(e)}`,createHints:function(t,e,i,o,s,l){const{fontFamily:r,fontSize:a}=s,{hintText:f,settings:c}=s.hints,h=p(m,c),{focus:u,borderRadius:d,padding:x,mark:g,splitter:b}=h,{innerRadius:y,outerRadius:v}=u.points,M=n(),{transform:R}=l,L=[],S=i.pixelRatio,E={...g};E.offsetLeft*=S,E.offsetTop*=S,E.innerRadius*=S,E.outerRadius*=S;const P={...x};P.left*=S,P.top*=S,P.right*=S,P.bottom*=S;const w={...b};w.height*=S;const A=a*S;t.font=`${A}px/1 ${r}`;for(let e=0,i=o.length;e<i;e++){const i=o[e],n=i.focusPoint;if(n){R(M,n);const e=f(n[0],n[1],i,s,n.source).split("\n");let o=0,l=0,r=0;for(let i=0,n=e.length;i<n;i++){const n=t.measureText(e[i]),s=n.width;o<s&&(o=s),l+=A;const a=-Math.abs(n.actualBoundingBoxAscent);r=A-(Math.abs(n.actualBoundingBoxDescent)-a)}l+=P.top+P.bottom+r,o+=P.left+P.right;const a=M[0]+20,c=M[1]-l/2;L.push({focusPoints:[{x:M[0],y:M[1],innerRadius:y(i)*S,outerRadius:v(i)*S,dataset:i}],left:a,top:c,right:a+o,bottom:c+l,correction:r,texts:[{offsetLeft:P.left,offsetTop:P.top,contents:e}],padding:P,marks:[{...E,dataset:i}]})}}return R(M,e),{ctx:t,focus:{origin:e,x:M[0],y:M[1]},viewport:{...i,backgroundColor:s.backgroundColor},settings:p(h,{font:{family:r,size:A},borderRadius:d?[Math.round(d.leftTop*S),Math.round(d.rightTop*S),Math.round(d.rightBottom*S),Math.round(d.leftBottom*S)]:null,splitter:w}),helpers:l,list:L}},displaceHints:t=>{const{list:e,settings:i,viewport:{width:n,height:o,pixelRatio:s},helpers:{isIntersects:l}}=t,{viewportPadding:r,splitter:{height:a}}=i,f=r.left*s,c=n-r.right*s,h=r.top*s,u=o-r.bottom*s;let d=[...e].sort(((t,e)=>t.focusPoints[t.focusPoints.length-1].y-e.focusPoints[0].y)),x=!0,g=0;for(;x;){g++,x=!1;for(let t=0,e=d.length;t<e;t++){const i=d[t];if(null!==i){for(let n=t+1;n<e;n++){const t=d[n];if(null!==t&&l(i,t)){const e=i.bottom-i.top-i.padding.bottom-t.padding.top-i.correction+a;for(let i=0,n=t.texts.length;i<n;i++)t.texts[i].offsetTop+=e;for(let i=0,n=t.marks.length;i<n;i++)t.marks[i].offsetTop+=e;i.right=Math.max(i.right,i.left+(t.right-t.left)),i.bottom+=t.bottom-t.top-i.padding.bottom-t.padding.top-i.correction+a,i.texts=i.texts.concat(t.texts),i.focusPoints=i.focusPoints.concat(t.focusPoints),i.marks=i.marks.concat(t.marks),d[n]=null,x=!0}}d[t]=i}}if(!i.unitInvisibleHints)for(let t=0,e=d.length;t<e;t++){const e=d[t];null!==e&&(e.right<f||e.left>c||e.bottom<h||e.top>u)&&(d[t]=null,x=!0)}d=d.filter((t=>t));for(let t=0,e=d.length;t<e;t++){const e=d[t];if(e.left<f){const t=f-e.left;e.left+=t,e.right+=t,x=!0}else if(e.right>c){const t=e.right-c;e.left-=t,e.right-=t,x=!0}if(e.top<h){const t=h-e.top;e.top+=t,e.bottom+=t,x=!0}else if(e.bottom>u){const t=e.bottom-u;e.top-=t,e.bottom-=t,x=!0}}if(d.length<=1||g>=i.maxNumIterations)break}return{...t,list:d}},renderHints:t=>{const{ctx:e,list:i,settings:{font:n,color:o,shadow:s,borderRadius:l,focus:{axes:r}},viewport:{width:a,height:f,pixelRatio:c,backgroundColor:h}}=t;for(let t=0,e=i.length;t<e;t++){const e=i[t],{left:n,top:o,right:s,bottom:l}=e;e.rect={left:Math.round(n),top:Math.round(o),width:Math.round(s-n),height:Math.round(l-o)}}if(r.y){const{color:t,lineWidth:n}=r.y;e.fillStyle=t;for(let t=0,o=i.length;t<o;t++){const{focusPoints:o}=i[t];for(let t=0,i=o.length;t<i;t++){const{y:i}=o[t];e.fillRect(0,i,a,Math.round(n*c))}}}if(r.x){const{color:i,lineWidth:n}=r.x;e.fillStyle=i,e.fillRect(t.focus.x,0,Math.round(n*c),f)}if(s){const{offsetX:t,offsetY:n,blur:o,color:r}=s;e.fillStyle="rgb(255,255,255)",e.shadowColor=r,e.shadowOffsetX=t,e.shadowOffsetY=n,e.shadowBlur=o;for(let t=0,n=i.length;t<n;t++){const{left:n,top:o,width:s,height:r}=i[t].rect;l?(e.beginPath(),e.roundRect(n,o,s,r,l),e.fill()):e.fillRect(n,o,s,r)}e.shadowColor="transparent"}for(let t=0,n=i.length;t<n;t++){const{focusPoints:n}=i[t];for(let t=0,i=n.length;t<i;t++){const{x:i,y:o,innerRadius:s,outerRadius:l,dataset:{options:{lineColor:r}}}=n[t],a=Math.round(i),f=Math.round(o);e.fillStyle=r.toString(),e.beginPath(),e.arc(a,f,Math.round(l),0,2*Math.PI,!1),e.fill(),e.fillStyle=h,e.beginPath(),e.arc(a,f,Math.round(s),0,2*Math.PI,!1),e.fill()}}const{border:u,background:d,text:x}=o,g=n.size;e.font=`${Math.round(g)}px/1 ${n.family}`;for(let t=0,n=i.length;t<n;t++){const{rect:{left:n,top:o,width:s,height:r},texts:a,marks:f}=i[t];e.strokeStyle=u,e.fillStyle=d,l?(e.beginPath(),e.roundRect(n,o,s,r,l),e.fill(),e.stroke()):e.fillRect(n,o,s,r),e.fillStyle=x;for(let t=0,i=a.length;t<i;t++){const{offsetLeft:i,offsetTop:s,contents:l}=a[t],r=Math.round(i+n);let f=s+o;for(let t=0,i=l.length;t<i;t++)e.fillText(l[t],r,Math.round(f+g)),f+=g}for(let t=0,i=f.length;t<i;t++){const{offsetLeft:i,offsetTop:s,innerRadius:l,outerRadius:r,dataset:{options:{lineColor:a}}}=f[t],c=Math.round(i+n),u=Math.round(s+o);e.fillStyle=a.toString(),e.beginPath(),e.arc(c,u,r,0,2*Math.PI,!1),e.fill(),e.fillStyle=h,e.beginPath(),e.arc(c,u,l,0,2*Math.PI,!1),e.fill()}}}},legends:{settings:{color:{border:"#eeeeee",background:"#ffffff",text:"#000000"},padding:{left:5,right:5,top:5,bottom:5},itemPadding:{left:25,right:10,top:5,bottom:5},mark:{offsetLeft:15,offsetTop:15,innerRadius:0,outerRadius:3}},legendText:(t,e)=>`${t.legend}`,createLegends:function(t,e,i,n){const{legendText:o,settings:s}=n.legends,l=p(b,s),{itemPadding:r,padding:a,mark:f}=l,{fontFamily:c,fontSize:h}=n;let u=[],d=0,x=0;const g=e.pixelRatio,m=h*g,y={...f};y.offsetLeft*=g,y.offsetTop*=g,y.innerRadius*=g,y.outerRadius*=g;const v={...a};v.left*=g,v.top*=g,v.right*=g,v.bottom*=g;const M={...r};M.left*=g,M.top*=g,M.right*=g,M.bottom*=g,t.font=`${m}px/1 ${c}`;for(let e=0,s=i.length;e<s;e++){const s=i[e],l=o(s,n);if(l){const e=t.measureText(l),i=e.width+M.left+M.right*g,n=-Math.abs(e.actualBoundingBoxAscent),o=Math.abs(e.actualBoundingBoxDescent);x=Math.max(x,m-(o-n)),u.push({text:{content:l,offsetLeft:M.left,offsetTop:M.top},mark:y,dataset:s,width:i,left:0,top:0}),d<i&&(d=i)}}const R=e.width-v.left-v.right,L=Math.floor(R/d);let S=0,E=0;const P=m+M.top+M.bottom+x;for(let t=0,e=u.length;t<e;t++){const e=u[t],i=t%L,n=Math.floor(t/L);S<i&&(S=i),E<n&&(E=n),e.left=i*d,e.top=n*P}const w=(E+1)*P+v.top+v.bottom,A=v.left+(R-(S+1)*d)/2,T=e.height-w+v.top;for(let t=0,e=u.length;t<e;t++){const e=u[t];e.left+=A,e.top+=T}return e.clip(0,0,e.width,e.height-w),{ctx:t,area:{left:0,right:e.width,top:e.height-w,bottom:e.height},viewport:{...e,backgroundColor:n.backgroundColor},settings:p(l,{font:{family:c,size:m}}),list:u}},renderLegends:function(t){const{ctx:e,area:i,settings:{font:n,color:o},viewport:{pixelRatio:s,backgroundColor:l},list:r}=t;if(o.background){const t=Math.round(i.left),n=Math.round(i.top),l=Math.round(i.right),r=Math.round(i.bottom);e.fillStyle=o.background,e.fillRect(t,n,l-t,r-n),o.border&&(e.fillStyle=o.border,e.fillRect(t,n,l-t,Math.round(1*s)))}const a=n.size;e.font=`${Math.round(a)}px/1 ${n.family}`;for(let t=0,i=r.length;t<i;t++){let{left:i,top:s,text:a,mark:f,dataset:{options:{lineColor:c}}}=r[t];e.fillStyle=o.text;{let{offsetLeft:t,offsetTop:o,content:l}=a;t+=i,o+=s,e.fillText(l,Math.round(t),Math.round(o+n.size))}{const{offsetLeft:t,offsetTop:n,innerRadius:o,outerRadius:r}=f,a=Math.round(t+i),h=Math.round(n+s);e.fillStyle=c.toString(),e.beginPath(),e.arc(a,h,Math.round(r),0,2*Math.PI,!1),e.fill(),e.fillStyle=l,e.beginPath(),e.arc(a,h,Math.round(o),0,2*Math.PI,!1),e.fill()}}}},cursorPointer:"pointer",cursorGrabbing:"grabbing",bindEventHandlers:!0,invertMouseWheel:!1,mouseWheelStep:.1,afterRepaint:null},R=class{constructor(t,e={}){this.options=e=p(M,e),this.elCanvas=t,this.ctx=t.getContext("2d"),this.scale=n(e.xScale,e.yScale),this.translate=n(e.xOffset,e.yOffset),this.focusPoint=n(0,0),this.datasets=[],this.currentXBounds=n(),t.style.cursor=e.cursorPointer;const i={down:!1,pt0:n(0,0),pt:n(0,0),delta:n(0,0)},r=(i,n)=>{const{clientX:o,clientY:s}=n,{left:l,right:r,top:a,bottom:f}=t.getBoundingClientRect();return i[0]=(o-l)/e.canvasRatio,i[1]=(s-a)/e.canvasRatio,l<=o&&o<=r&&a<=s&&s<=f};this.isListening=!1,this.listeners={},this.listeners[g.EVT_NAME_POINTERDOWN]=n=>{t.style.cursor=e.cursorGrabbing,n.detail.originalEvent.preventDefault(),i.down=!0,r(i.pt0,n.detail)},this.listeners[g.EVT_NAME_POINTERUP]=n=>{i.down=!1,t.style.cursor=e.cursorPointer},this.listeners[g.EVT_NAME_POINTERMOVE]=t=>{const a=r(i.pt,t.detail);if(i.down){f=i.delta,c=i.pt,h=i.pt0,f[0]=c[0]-h[0],f[1]=c[1]-h[1],o(i.pt0,i.pt);const t=n(e.userTranslateX?i.delta[0]:0,e.userTranslateY?i.delta[1]:0);this.move(t),this.repaint()}else if(a){const t=n();!function(t,e,i,n){t[0]=(e[0]-n[0])/i[0],t[1]=(e[1]-n[1])/i[1]}(t,i.pt,n(e.xCanvasStep,e.yCanvasStep),this.translate),t[1]=-t[1],s(t,t,n(e.xAxisStep,e.yAxisStep)),l(t,t,this.scale),this.computeFocusPoints(t),this.repaint()}var f,c,h},this.listeners[g.EVT_NAME_POINTERZOOM]=t=>{t.detail.originalEvent.preventDefault();const o=t.detail.deltaScale,s=n(!0===e.userScaleX||"function"==typeof e.userScaleX&&e.userScaleX(t)?o:0,!0===e.userScaleY||"function"==typeof e.userScaleY&&e.userScaleY(t)?o:0);r(i.pt,t.detail),this.zoomAroundPoint(s,i.pt),this.repaint()},this.touchGestures=new g(t,{invertMouseWheel:e.invertMouseWheel,mouseWheelStep:e.mouseWheelStep}),e.bindEventHandlers&&this.bind()}computeFocusPoints(t){this.datasets.forEach((e=>{const{source:i}=e,o=i.length,s=((t,e,n,o)=>{let s=-1;for(;e<=n;){let t=e+Math.floor((n-e+1)/2),r=(l=t,i.at(l)[0]);r<o?(s=t,e=t+1):(r>o||r===o)&&(n=t-1)}var l;return s})(0,0,o-1,t[0]),l=s+1;if(s>=0&&l<o){const o=n(),r=i.at(s),a=i.at(l),f=(t[0]-r[0])/(a[0]-r[0]),c=n(f,e.options.isStepped?0:f);!function(t,e,i,n){t[0]=e[0]+n[0]*(i[0]-e[0]),t[1]=e[1]+n[1]*(i[1]-e[1])}(o,r,a,c),o.source={i0:s,i1:l,s:c},e.focusPoint=o}else e.focusPoint=null})),o(this.focusPoint,t)}bind(){if(!this.isListening){for(let t in this.listeners)this.elCanvas.addEventListener(t,this.listeners[t]);this.touchGestures.enableTouchGestures(),this.touchGestures.enableMouseGestures(),this.isListening=!0}}unbind(){if(this.isListening){for(let t in this.listeners)this.elCanvas.removeEventListener(t,this.listeners[t]);this.touchGestures.disableTouchGestures(),this.touchGestures.disableMouseGestures(),this.isListening=!1}}getViewportXBounds(){return n((t=this.currentXBounds)[0],t[1]);var t}fitView(t,e=!0){let i=this.elCanvas.width,o=this.elCanvas.height;if(i<=0||o<=0||Math.abs(t.width)<=0||Math.abs(t.height)<=0)return!1;const s=this.options;s.legends&&s.legends.createLegends(this.ctx,{width:i,height:o,pixelRatio:s.canvasRatio*s.canvasPixelRatio,clip(t,e,n,s){i=n-t,o=s-e}},this.datasets,s,{isIntersects:y});const l=new DOMRect(t.x,-t.y-t.height,t.width,t.height),r=s.canvasRatio*s.canvasPixelRatio,a=n(s.xCanvasStep,s.yCanvasStep),f=n(s.xAxisStep,s.yAxisStep);if(i=i/r/a[0]*f[0],o=o/r/a[1]*f[1],this.scale[0]=i/l.width,this.scale[1]=o/l.height,e&&(this.scale[1]>this.scale[0]?this.scale[1]=this.scale[0]:this.scale[0]=this.scale[1]),this.translate[0]=-l.x/f[0]*a[0]*this.scale[0],this.translate[1]=-l.y/f[1]*a[1]*this.scale[1],e){const t=(i/this.scale[0]-l.width)/2,e=(o/this.scale[1]-l.height)/2;this.translate[0]+=t*a[0]*this.scale[0]/f[0],this.translate[1]+=e*a[1]*this.scale[1]/f[1]}return!0}fitViewAuto(t=!0){this.fitView(this.getBoundingRect(null,0,null,0),t),this.repaint()}getExtrems(t=null,e=null,i=null,n=null){let o=t,s=i,l=e,r=n;return this.datasets.forEach((t=>{const e=t.getExtrems();(null===o||o>e.minX)&&(o=e.minX),(null===s||s<e.maxX)&&(s=e.maxX),(null===l||l>e.minY)&&(l=e.minY),(null===r||r<e.maxY)&&(r=e.maxY)})),{minX:o,minY:l,maxX:s,maxY:r}}getBoundingRect(t=null,e=null,i=null,n=null){const{minX:o,minY:s,maxX:l,maxY:r}=this.getExtrems(),a=new DOMRect(o,s,l-o,r-s);return a.minX=o,a.minY=s,a.maxX=l,a.maxY=r,a}move(t){var e,i,n;e=this.translate,i=this.translate,n=t,e[0]=i[0]+n[0],e[1]=i[1]+n[1]}zoomAroundPoint(t,e){const i=this.translate,n=this.scale;!function(t,e,i,n){t[0]=e[0]-n[0]*(i[0]-e[0]),t[1]=e[1]-n[1]*(i[1]-e[1])}(i,i,e,t),r(n,n,t,n)}repaint(){let t,e;const o=this.options,a=this.ctx;let f=this.elCanvas.width,c=this.elCanvas.height;const h=this.scale,u=this.datasets;if(f<=0||c<=0||0===h[0]||0===h[1])return;const d=o.canvasRatio*o.canvasPixelRatio,x=n(o.xCanvasStep*d,o.yCanvasStep*d),g=n(this.translate[0]*d,this.translate[1]*d),p=n(x[0]*h[0],x[1]*h[1]),m=n(o.xAxisStep,o.yAxisStep),b=n(1,1),M=n(o.xAxisSubdivisions,o.yAxisSubdivisions);for(;p[0]>x[0]*M[0];)p[0]/=M[0],b[0]/=M[0];for(;p[1]>x[1]*M[1];)p[1]/=M[1],b[1]/=M[1];for(;p[0]<x[0];)p[0]*=M[0],b[0]*=M[0];for(;p[1]<x[1];)p[1]*=M[1],b[1]*=M[1];const R=g[0]-(Math.floor(g[0]/p[0])+(g[0]>0?1:0))*p[0],L=g[1]-(Math.floor(g[1]/p[1])+(g[1]>0?1:0))*p[1],S=(t,e)=>{s(t,e,x),l(t,t,m),t[1]=-t[1],r(t,t,h,g)};o.clearFrame&&a.clearRect(0,0,f,c),a.fillStyle=o.backgroundColor,a.fillRect(0,0,f,c);let E=null;if(o.legends){const{createLegends:t,renderLegends:e}=o.legends;e(t(a,{width:f,height:c,pixelRatio:d,clip(t,e,i,n){f=i-t,c=n-e,E=new Path2D,E.rect(t,e,f,c)}},u,o,{isIntersects:y}))}E&&(a.save(),a.clip(E)),a.fillStyle=o.gridColor;for(let t=R;t<=f;t+=p[0])a.fillRect(t,0,1*d,c);for(let t=L;t<=c;t+=p[1])a.fillRect(0,t,f,1*d);a.fillStyle=o.axesColor,a.fillRect(g[0],0,1*d,c),a.fillRect(0,g[1],f,1*d);for(let t=0,e=u.length;t<e;t++){const e=u[t],{source:i,tree:o}=e;if(i.length>1){a.strokeStyle=e.options.lineColor,a.lineWidth=e.options.lineWidth*d;const t=n(),s=n(),l=(e,i,n)=>{if(S(s,[i.maxX,i.maxY]),s[0]<0)return;if(S(t,[i.minX,i.minY]),t[0]>f)return;const o=Math.round(t[0]),r=Math.round(s[0]);if(o===r)e.beginPath(),e.moveTo(o,t[1]),e.lineTo(r,s[1]),e.stroke();else if(i.left&&i.right)l(e,i.left,n),l(e,i.right,n);else{e.beginPath(),S(t,n.at(i.s)),e.moveTo(t[0],t[1]);for(let o=i.s+1;o<=i.e;o++)S(t,n.at(o)),e.lineTo(t[0],t[1]);e.stroke()}},r=(e,i,n)=>{if(S(s,[i.maxX,i.maxY]),s[0]<0)return;if(S(t,[i.minX,i.minY]),t[0]>f)return;const o=Math.round(t[0]),l=Math.round(s[0]);if(o===l)e.beginPath(),e.moveTo(o,t[1]),e.lineTo(l,s[1]),e.stroke();else if(i.left&&i.right)r(e,i.left,n),r(e,i.right,n);else{e.beginPath(),S(t,n.at(i.s)),e.moveTo(t[0],t[1]);let o=t[1];for(let s=i.s+1;s<=i.e;s++)S(t,n.at(s)),e.lineTo(t[0],o),e.lineTo(t[0],t[1]),o=t[1];e.stroke()}},c=2*Math.PI,h=(e,i,n,o)=>{if(S(s,[i.maxX,i.maxY]),s[0]<0)return;if(S(t,[i.minX,i.minY]),t[0]>f)return;const l=Math.round(t[0]),r=Math.round(s[0]);if(l===r)e.beginPath(),e.arc(l,t[1],o,0,c,!1),e.fill(),e.beginPath(),e.arc(r,s[1],o,0,c,!1),e.stroke();else if(i.left&&i.right)h(e,i.left,n,o),h(e,i.right,n,o);else{for(let s=i.s;s<=i.e;s++)S(t,n.at(s)),e.beginPath(),e.arc(t[0],t[1],o,0,c,!1),e.fill();e.stroke()}};e.options.isStepped?r(a,o,i):l(a,o,i);const u=e.options.pointRadius;u>0&&(a.fillStyle=e.options.lineColor,h(a,o,i,u))}}if(o.xAxisLabelEnable||o.yAxisLabelEnable){const n=o.fontSize*d;if(a.font=`${n}px/1 ${o.fontFamily}`,a.fillStyle=o.axesColor,this.currentXBounds[0]=(0-g[0])/p[0]*b[0]*m[0],this.currentXBounds[1]=(f-g[0])/p[0]*b[0]*m[0],o.xAxisLabelEnable){const t=o.xAxisLabelXOffset*d,s=o.xAxisLabelYOffset*d,l=o.xAxisLabelMarkOffset*d,r=o.xAxisLabelMarkSize*d,h=o.xAxisLabelSpacing*d,u=h/2;let x=[],y=!1,M=!1;for(let e=R;e<=f;e+=p[0]){const i=e-g[0],l=Math.round(i/p[0]),r=l*b[0]*m[0],f=o.xAxisLabelFormat(r),h=a.measureText(f),u={i:l,gridX:e,text:f,textMetrics:h,x:e-h.width/2+t,y:g[1]+n+s};x.push(u),u.y-n-s<0&&(y=!0),u.y+s>c&&(M=!0)}for(let t=0,i=x.length;t<i;t++){const i=x[t];e=i.y,o.xAxisLabelDynamicPosition&&(e=y?n+s:M?c-s:e);const l=new DOMRect(i.x-u,e-n,i.textMetrics.width+h,n);i.y=e,i.boundingRect=l}let L=o.xAxisLabelJoiningStep,S=x;for(;v(x);)x=S.filter((t=>i(Math.abs(t.i)%L))),L+=o.xAxisLabelJoiningStep;for(let t=0,e=x.length;t<e;t++){const e=x[t];(o.xAxisLabelDisplayZero||0!==e.i)&&(a.fillRect(e.gridX,g[1]+l,d,r),a.fillText(e.text,e.x,e.y))}}if(o.yAxisLabelEnable){const e=o.yAxisLabelXOffset*d,s=o.yAxisLabelYOffset*d,l=o.yAxisLabelMarkOffset*d,r=o.yAxisLabelMarkSize*d,h=o.yAxisLabelSpacing*d,u=h/2;let x=[],y=0,M=!1,R=!1;for(let t=L;t<=c;t+=p[1]){const i=g[1]-t,l=Math.round(i/p[1]),r=l*b[1]*m[1],c=o.yAxisLabelFormat(r),h=a.measureText(c),u={i:l,gridY:t,text:c,textMetrics:h,x:g[0]-h.width+e,y:t+n/2+s};x.push(u),y<h.width&&(y=h.width),u.x+e<0&&(M=!0),u.x+u.textMetrics.width-e>f&&(R=!0)}for(let i=0,s=x.length;i<s;i++){const s=x[i];t=s.x,o.yAxisLabelDynamicPosition&&(t=M?y-s.textMetrics.width-e:R?f-s.textMetrics.width+e:t);const l=new DOMRect(t,s.y-n-u,s.textMetrics.width,n+h);s.x=t,s.boundingRect=l}let S=o.yAxisLabelJoiningStep,E=x;for(;v(x);)x=E.filter((t=>i(Math.abs(t.i)%S))),S+=o.yAxisLabelJoiningStep;x=x.filter((t=>t.boundingRect.bottom>0&&t.boundingRect.top<c)),y=0,M=!1,R=!1;for(let t=0,i=x.length;t<i;t++){const i=x[t];i.x=g[0]-i.textMetrics.width+e,y<i.textMetrics.width&&(y=i.textMetrics.width),i.x+e<0&&(M=!0),i.x+i.textMetrics.width-e>f&&(R=!0)}for(let i=0,n=x.length;i<n;i++){const n=x[i];t=n.x,o.yAxisLabelDynamicPosition&&(t=M?y-n.textMetrics.width-e:R?f-n.textMetrics.width+e:t),n.x=t}for(let t=0,e=x.length;t<e;t++){const e=x[t];(o.yAxisLabelDisplayZero||0!==e.i)&&(a.fillRect(g[0]+l,e.gridY,r,d),a.fillText(e.text,e.x,e.y))}}}if(o.hints){const{createHints:t,displaceHints:e,renderHints:i}=o.hints;let n=t(a,this.focusPoint,{width:f,height:c,pixelRatio:d},u,o,{transform:S,isIntersects:y});n=e(n),i(n)}E&&a.restore(),o.afterRepaint&&o.afterRepaint()}},L=(t,e,i,n)=>{const o=i-e<=n;let s,l,[r,a]=t.at(e),[f,c]=t.at(i);if(o)for(let n=e;n<=i;n++){const e=t.at(n)[1];a>e&&(a=e),c<e&&(c=e)}else{const o=e+Math.floor((i-e)/2);s=L(t,e,o,n),l=L(t,o,i,n),a=Math.min(s.minY,l.minY),c=Math.max(s.maxY,l.maxY)}return{s:e,e:i,minX:r,minY:a,maxX:f,maxY:c,left:s,right:l}},S=class{constructor(t="",e={}){if(!("lineColor"in e)){const t=()=>Math.round(256*Math.random());e.lineColor=`rgb(${t()},${t()},${t()})`}"isStepped"in e||(e.isStepped=!1),"lineWidth"in e||(e.lineWidth=1),"pointRadius"in e||(e.pointRadius=0),this.legend=t,this.options=e}compile(t,e){this.source=t,this.rebuild(e)}rebuild(t=100){const e=this.source,i=e.length;this.tree=i>0?L(e,0,i-1,t):null}getExtrems(t=null,e=null,i=null,n=null){let o=t,s=i,l=e,r=n;const{source:a}=this;for(let t=0,e=a.length;t<e;t++){const[e,i]=a.at(t);(null===o||o>e)&&(o=e),(null===s||s<e)&&(s=e),(null===l||l>i)&&(l=i),(null===r||r<i)&&(r=i)}return{minX:o,minY:l,maxX:s,maxY:r}}getBoundingRect(){const{minX:t,minY:e,maxX:i,maxY:n}=this.getExtrems(),o=new DOMRect(t,e,i-t,n-e);return o.minX=t,o.minY=e,o.maxX=i,o.maxY=n,o}};return e})()));